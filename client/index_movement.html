<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimum-scale=1.0, maximum-scale=1.0">
    <title>movement</title>
    <script type="text/javascript" src="http://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>
    <link rel="stylesheet" href="/app/main/main.css" media="screen" title="no title" charset="utf-8">
</head>
<body>

<style>
.body {
    background-image: url(http://www.kfc.com/assets/images/touts/busy-people.jpg);
    background-position: 50%;
}
</style>

<div class="body"></div>

<div class="points">
    <div class="wrapper">
        <div class="point"><i></i></div>
        <div class="point"><i></i></div>
        <div class="point"><i></i></div>
        <div class="point"><i></i></div>
        <div class="point"><i></i></div>
        <div class="point"><i></i></div>
        <div class="point"><i></i></div>
        <div class="point"><i></i></div>
        <div class="point"><i></i></div>
        <div class="point"><i></i></div>
        <div class="point"><i></i></div>
        <div class="point"><i></i></div>
        <div class="point"><i></i></div>
        <div class="point"><i></i></div>
        <div class="point"><i></i></div>
    </div>

    <div class="slider"></div>
</div>

<script type="text/javascript">
!function () {
    var _lastPositon = null;
    var pot = 1;
    // var sliding = false;
    // $('.body').on('touchstart', function (e) {
    //     // if (move) return;
    //     // move = true;
    //     _lastPositon = e.originalEvent.touches[0].pageX;
    // });
    // $('.body').on('touchend', function (e) {
    //     console.log(sliding);
    //     if (!sliding) sliding = true;
    //     else return;
    //     var nowPosition = e.originalEvent.changedTouches[0].pageX;
    //     var changed = nowPosition - _lastPositon;
    //     // if(!_lastPositon) return;
    //
    //     if (nowPosition < _lastPositon) {
    //         console.log('right');
    //         if (pot >= 10) return sliding = false;
    //         var left = $('.slider').position().left + 22.85;
    //         // $('.slider').css('left', left+'px');
    //         // pot++;
    //         // sliding = false;
    //         $('.slider').animate({left: left + 'px'}, function () {
    //             pot++;
    //             sliding = false;
    //             return;
    //         });
    //     } else if (nowPosition > _lastPositon) {
    //         console.log('left');
    //         if (pot <= 1) return sliding = false;
    //         var left = $('.slider').position().left - 22.85;
    //         // $('.slider').css('left', left+'px');
    //         // pot--;
    //         // sliding = false;
    //         $('.slider').animate({left: left + 'px'}, function () {
    //             pot--;
    //             sliding = false;
    //             return;
    //         });
    //     } else {
    //         sliding = false;
    //         return;
    //     }
    // });
    var start = false;
    var end = false;
    $('.body').on('touchstart', function (e) {
        console.log('start: ', start);
        if (!start) start = true;
        else return;
        _lastPositon = e.originalEvent.touches[0].pageX;
    });
    $('.body').on('touchend', function (e) {
        console.log('end: ', end);
        if (!end) end = true;
        else return;
        var nowPosition = e.originalEvent.changedTouches[0].pageX;
        var changed = nowPosition - _lastPositon;

        if (nowPosition < _lastPositon) {
            console.log('right');
            if (pot >= 10) {start = false; end = false; return;}
            var left = $('.slider').position().left + 22.85;
            // $('.slider').css('left', left+'px');
            // pot++;
            // start = false;
            $('.slider').animate({left: left + 'px'}, refresh);
            pot++;
            return;
        } else if (nowPosition > _lastPositon) {
            console.log('left');
            if (pot <= 1) {start = false; end = false; return;}
            var left = $('.slider').position().left - 22.85;
            // $('.slider').css('left', left+'px');
            // pot--;
            // sliding = false;
            $('.slider').animate({left: left + 'px'}, refresh);
            pot--;
            return;
        } else {
            start = false;
            end = false;
            return;
        }
    });
    function refresh () {console.log('refresh');setTimeout(function () {start = false; end = false; return;}, 500);}
}();

</script>

</body>
</html>
